2019-11-05 11:16:47 jdbc[3]: exception
org.h2.jdbc.JdbcSQLException: Столбец "FILMID" не найден
Column "FILMID" not found; SQL statement:
create table reviews ( id number(10) primary key AUTO_INCREMENT,author number(10),text varchar2(500),rating number(1),postDate date,film_id varchar2(50),FOREIGN KEY (author)  REFERENCES users (id),FOREIGN KEY (filmID)  REFERENCES films (imdbId)) [42122-197]
	at org.h2.message.DbException.getJdbcSQLException(DbException.java:357)
	at org.h2.message.DbException.get(DbException.java:179)
	at org.h2.message.DbException.get(DbException.java:155)
	at org.h2.table.Table.getColumn(Table.java:682)
	at org.h2.table.IndexColumn.mapColumns(IndexColumn.java:74)
	at org.h2.command.ddl.AlterTableAddConstraint.tryUpdate(AlterTableAddConstraint.java:212)
	at org.h2.command.ddl.AlterTableAddConstraint.update(AlterTableAddConstraint.java:78)
	at org.h2.command.ddl.CommandWithColumns.createConstraints(CommandWithColumns.java:88)
	at org.h2.command.ddl.CreateTable.update(CreateTable.java:122)
	at org.h2.command.CommandContainer.update(CommandContainer.java:102)
	at org.h2.command.Command.executeUpdate(Command.java:261)
	at org.h2.jdbc.JdbcStatement.executeInternal(JdbcStatement.java:233)
	at org.h2.jdbc.JdbcStatement.execute(JdbcStatement.java:205)
	at com.tstu.repositoryJDBC.Test.DataBaseConnection.dB(DataBaseConnection.java:48)
	at com.tstu.App.main(App.java:36)
2019-11-05 11:17:15 jdbc[3]: exception
org.h2.jdbc.JdbcSQLException: Таблица "USERS" уже существует
Table "USERS" already exists; SQL statement:
create table users ( id number(10) primary key AUTO_INCREMENT,username varchar2(20),password varchar2(20)) [42101-197]
2019-11-05 12:58:43 jdbc[3]: exception
org.h2.jdbc.JdbcSQLException: Столбец "DATE" не найден
Column "DATE" not found; SQL statement:
insert into films(imdbId,name,type,date) values('tt0093058','Цельнометаллическая оболочка','Фильм','1987-07-10') [42122-197]
	at org.h2.message.DbException.getJdbcSQLException(DbException.java:357)
	at org.h2.message.DbException.get(DbException.java:179)
	at org.h2.message.DbException.get(DbException.java:155)
	at org.h2.table.Table.getColumn(Table.java:682)
	at org.h2.command.Parser.parseColumn(Parser.java:936)
	at org.h2.command.Parser.parseColumnList(Parser.java:920)
	at org.h2.command.Parser.parseInsertGivenTable(Parser.java:1258)
	at org.h2.command.Parser.parseInsert(Parser.java:1222)
	at org.h2.command.Parser.parsePrepared(Parser.java:431)
	at org.h2.command.Parser.parse(Parser.java:335)
	at org.h2.command.Parser.parse(Parser.java:307)
	at org.h2.command.Parser.prepareCommand(Parser.java:278)
	at org.h2.engine.Session.prepareLocal(Session.java:611)
	at org.h2.engine.Session.prepareCommand(Session.java:549)
	at org.h2.jdbc.JdbcConnection.prepareCommand(JdbcConnection.java:1247)
	at org.h2.jdbc.JdbcStatement.executeUpdateInternal(JdbcStatement.java:165)
	at org.h2.jdbc.JdbcStatement.executeUpdate(JdbcStatement.java:126)
	at com.tstu.repositoryJDBC.Test.DataBaseConnection.dB(DataBaseConnection.java:29)
	at com.tstu.App.main(App.java:36)
2019-11-05 13:44:13 jdbc[3]: exception
org.h2.jdbc.JdbcSQLException: Столбец "GENRE" не найден
Column "GENRE" not found; SQL statement:
select imdbId,name,type,genre,releaseDate from films where name like ? and imdbId like ? and type like ? and genre like ? and releaseDate like ? [42122-197]
	at org.h2.message.DbException.getJdbcSQLException(DbException.java:357)
	at org.h2.message.DbException.get(DbException.java:179)
	at org.h2.message.DbException.get(DbException.java:155)
	at org.h2.expression.ExpressionColumn.optimize(ExpressionColumn.java:150)
	at org.h2.command.dml.Select.prepare(Select.java:858)
	at org.h2.command.Parser.prepareCommand(Parser.java:283)
	at org.h2.engine.Session.prepareLocal(Session.java:611)
	at org.h2.engine.Session.prepareCommand(Session.java:549)
	at org.h2.jdbc.JdbcConnection.prepareCommand(JdbcConnection.java:1247)
	at org.h2.jdbc.JdbcPreparedStatement.<init>(JdbcPreparedStatement.java:76)
	at org.h2.jdbc.JdbcConnection.prepareStatement(JdbcConnection.java:304)
	at com.tstu.repositoryJDBC.FilmRepositoryImplJDBC.findFilmList(FilmRepositoryImplJDBC.java:35)
	at com.tstu.service.FilmServiceImpl.findFilmList(FilmServiceImpl.java:34)
	at com.tstu.ui.states.FindFilmState.findFilmByName(FindFilmState.java:73)
	at com.tstu.ui.states.FindFilmState.handleCommand(FindFilmState.java:44)
	at com.tstu.ui.MenuState.enterCommand(MenuState.java:18)
	at com.tstu.ui.MenuState.display(MenuState.java:33)
	at com.tstu.ui.Menu.display(Menu.java:17)
	at com.tstu.ui.states.MainState.handleCommand(MainState.java:53)
	at com.tstu.ui.MenuState.enterCommand(MenuState.java:18)
	at com.tstu.ui.MenuState.display(MenuState.java:33)
	at com.tstu.ui.Menu.display(Menu.java:17)
	at com.tstu.App.main(App.java:22)
2019-11-05 15:39:22 jdbc[3]: exception
org.h2.jdbc.JdbcSQLException: Таблица "FILMSINNER" не найдена
Table "FILMSINNER" not found; SQL statement:
SELECT imdbId,name,type,releaseDate, GROUP_CONCAT(genres.name) AS genre FROM filmsINNER JOIN film_generes ON films.imdbId = film_generes.film_id LEFT JOIN genres ON film_generes.genre_id = genres.idWHERE name LIKE ? AND imdbId LIKE ? AND type LIKE ? AND releaseDate LIKE ? [42102-197]
2019-11-05 15:39:52 jdbc[3]: exception
org.h2.jdbc.JdbcSQLException: Неоднозначное имя столбца "NAME"
Ambiguous column name "NAME"; SQL statement:
SELECT imdbId,name,type,releaseDate, GROUP_CONCAT(genres.name) AS genre FROM films INNER JOIN film_generes ON films.imdbId = film_generes.film_id LEFT JOIN genres ON film_generes.genre_id = genres.idWHERE name LIKE ? AND imdbId LIKE ? AND type LIKE ? AND releaseDate LIKE ? [90059-197]
	at org.h2.message.DbException.getJdbcSQLException(DbException.java:357)
	at org.h2.message.DbException.get(DbException.java:179)
	at org.h2.message.DbException.get(DbException.java:155)
	at org.h2.expression.ExpressionColumn.mapColumn(ExpressionColumn.java:127)
	at org.h2.expression.ExpressionColumn.mapColumns(ExpressionColumn.java:97)
	at org.h2.command.dml.Select.mapColumns(Select.java:1237)
	at org.h2.command.dml.Select.init(Select.java:826)
	at org.h2.command.Parser.parseSelect(Parser.java:1925)
	at org.h2.command.Parser.parsePrepared(Parser.java:463)
	at org.h2.command.Parser.parse(Parser.java:335)
	at org.h2.command.Parser.parse(Parser.java:307)
	at org.h2.command.Parser.prepareCommand(Parser.java:278)
	at org.h2.engine.Session.prepareLocal(Session.java:611)
	at org.h2.engine.Session.prepareCommand(Session.java:549)
	at org.h2.jdbc.JdbcConnection.prepareCommand(JdbcConnection.java:1247)
	at org.h2.jdbc.JdbcPreparedStatement.<init>(JdbcPreparedStatement.java:76)
	at org.h2.jdbc.JdbcConnection.prepareStatement(JdbcConnection.java:304)
	at com.tstu.repositoryJDBC.FilmRepositoryImplJDBC.findFilmList(FilmRepositoryImplJDBC.java:35)
	at com.tstu.service.FilmServiceImpl.findFilmList(FilmServiceImpl.java:34)
	at com.tstu.ui.states.FindFilmState.findFilmByName(FindFilmState.java:73)
	at com.tstu.ui.states.FindFilmState.handleCommand(FindFilmState.java:44)
	at com.tstu.ui.MenuState.enterCommand(MenuState.java:18)
	at com.tstu.ui.MenuState.display(MenuState.java:33)
	at com.tstu.ui.Menu.display(Menu.java:17)
	at com.tstu.ui.states.MainState.handleCommand(MainState.java:53)
	at com.tstu.ui.MenuState.enterCommand(MenuState.java:18)
	at com.tstu.ui.MenuState.display(MenuState.java:33)
	at com.tstu.ui.Menu.display(Menu.java:17)
	at com.tstu.App.main(App.java:22)
2019-11-05 15:41:02 jdbc[3]: exception
org.h2.jdbc.JdbcSQLException: Неоднозначное имя столбца "NAME"
Ambiguous column name "NAME"; SQL statement:
SELECT imdbId,name,type,releaseDate, GROUP_CONCAT(genres.name) AS genre FROM films INNER JOIN film_generes ON films.imdbId = film_generes.film_id LEFT JOIN genres ON film_generes.genre_id = genres.id WHERE name LIKE ? AND imdbId LIKE ? AND type LIKE ? AND releaseDate LIKE ? [90059-197]
	at org.h2.message.DbException.getJdbcSQLException(DbException.java:357)
	at org.h2.message.DbException.get(DbException.java:179)
	at org.h2.message.DbException.get(DbException.java:155)
	at org.h2.expression.ExpressionColumn.mapColumn(ExpressionColumn.java:127)
	at org.h2.expression.ExpressionColumn.mapColumns(ExpressionColumn.java:97)
	at org.h2.command.dml.Select.mapColumns(Select.java:1237)
	at org.h2.command.dml.Select.init(Select.java:826)
	at org.h2.command.Parser.parseSelect(Parser.java:1925)
	at org.h2.command.Parser.parsePrepared(Parser.java:463)
	at org.h2.command.Parser.parse(Parser.java:335)
	at org.h2.command.Parser.parse(Parser.java:307)
	at org.h2.command.Parser.prepareCommand(Parser.java:278)
	at org.h2.engine.Session.prepareLocal(Session.java:611)
	at org.h2.engine.Session.prepareCommand(Session.java:549)
	at org.h2.jdbc.JdbcConnection.prepareCommand(JdbcConnection.java:1247)
	at org.h2.jdbc.JdbcPreparedStatement.<init>(JdbcPreparedStatement.java:76)
	at org.h2.jdbc.JdbcConnection.prepareStatement(JdbcConnection.java:304)
	at com.tstu.repositoryJDBC.FilmRepositoryImplJDBC.findFilmList(FilmRepositoryImplJDBC.java:35)
	at com.tstu.service.FilmServiceImpl.findFilmList(FilmServiceImpl.java:34)
	at com.tstu.ui.states.FindFilmState.findFilmByName(FindFilmState.java:73)
	at com.tstu.ui.states.FindFilmState.handleCommand(FindFilmState.java:44)
	at com.tstu.ui.MenuState.enterCommand(MenuState.java:18)
	at com.tstu.ui.MenuState.display(MenuState.java:33)
	at com.tstu.ui.Menu.display(Menu.java:17)
	at com.tstu.ui.states.MainState.handleCommand(MainState.java:53)
	at com.tstu.ui.MenuState.enterCommand(MenuState.java:18)
	at com.tstu.ui.MenuState.display(MenuState.java:33)
	at com.tstu.ui.Menu.display(Menu.java:17)
	at com.tstu.App.main(App.java:22)
2019-11-05 15:43:05 jdbc[3]: exception
org.h2.jdbc.JdbcSQLException: Неоднозначное имя столбца "NAME"
Ambiguous column name "NAME"; SQL statement:
SELECT imdbId,name,type,releaseDate, GROUP_CONCAT(genres.name) AS genre FROM films INNER JOIN film_generes ON films.imdbId = film_generes.film_id LEFT JOIN genres ON film_generes.genre_id = genres.id WHERE films.name LIKE ? AND imdbId LIKE ? AND type LIKE ? AND releaseDate LIKE ? [90059-197]
	at org.h2.message.DbException.getJdbcSQLException(DbException.java:357)
	at org.h2.message.DbException.get(DbException.java:179)
	at org.h2.message.DbException.get(DbException.java:155)
	at org.h2.expression.ExpressionColumn.mapColumn(ExpressionColumn.java:127)
	at org.h2.expression.ExpressionColumn.mapColumns(ExpressionColumn.java:97)
	at org.h2.command.dml.Select.mapColumns(Select.java:1237)
	at org.h2.command.dml.Select.init(Select.java:826)
	at org.h2.command.Parser.parseSelect(Parser.java:1925)
	at org.h2.command.Parser.parsePrepared(Parser.java:463)
	at org.h2.command.Parser.parse(Parser.java:335)
	at org.h2.command.Parser.parse(Parser.java:307)
	at org.h2.command.Parser.prepareCommand(Parser.java:278)
	at org.h2.engine.Session.prepareLocal(Session.java:611)
	at org.h2.engine.Session.prepareCommand(Session.java:549)
	at org.h2.jdbc.JdbcConnection.prepareCommand(JdbcConnection.java:1247)
	at org.h2.jdbc.JdbcPreparedStatement.<init>(JdbcPreparedStatement.java:76)
	at org.h2.jdbc.JdbcConnection.prepareStatement(JdbcConnection.java:304)
	at com.tstu.repositoryJDBC.FilmRepositoryImplJDBC.findFilmList(FilmRepositoryImplJDBC.java:35)
	at com.tstu.service.FilmServiceImpl.findFilmList(FilmServiceImpl.java:34)
	at com.tstu.ui.states.FindFilmState.findFilmByName(FindFilmState.java:73)
	at com.tstu.ui.states.FindFilmState.handleCommand(FindFilmState.java:44)
	at com.tstu.ui.MenuState.enterCommand(MenuState.java:18)
	at com.tstu.ui.MenuState.display(MenuState.java:33)
	at com.tstu.ui.Menu.display(Menu.java:17)
	at com.tstu.ui.states.MainState.handleCommand(MainState.java:53)
	at com.tstu.ui.MenuState.enterCommand(MenuState.java:18)
	at com.tstu.ui.MenuState.display(MenuState.java:33)
	at com.tstu.ui.Menu.display(Menu.java:17)
	at com.tstu.App.main(App.java:22)
2019-11-05 15:45:19 jdbc[3]: exception
org.h2.jdbc.JdbcSQLException: Столбец "FILMS.IMDBID" должен быть в предложении GROUP BY
Column "FILMS.IMDBID" must be in the GROUP BY list; SQL statement:
SELECT films.*, GROUP_CONCAT(genres.name) AS genre FROM films INNER JOIN film_generes ON films.imdbId = film_generes.film_id LEFT JOIN genres ON film_generes.genre_id = genres.id WHERE films.name LIKE ? AND imdbId LIKE ? AND type LIKE ? AND releaseDate LIKE ? [90016-197]
	at org.h2.message.DbException.getJdbcSQLException(DbException.java:357)
	at org.h2.message.DbException.get(DbException.java:179)
	at org.h2.message.DbException.get(DbException.java:155)
	at org.h2.expression.ExpressionColumn.updateAggregate(ExpressionColumn.java:172)
	at org.h2.command.dml.Select.queryGroup(Select.java:350)
	at org.h2.command.dml.Select.queryWithoutCache(Select.java:628)
	at org.h2.command.dml.Query.queryWithoutCacheLazyCheck(Query.java:114)
	at org.h2.command.dml.Query.query(Query.java:371)
	at org.h2.command.dml.Query.query(Query.java:333)
	at org.h2.command.CommandContainer.query(CommandContainer.java:114)
	at org.h2.command.Command.executeQuery(Command.java:202)
	at org.h2.jdbc.JdbcPreparedStatement.executeQuery(JdbcPreparedStatement.java:114)
	at com.tstu.repositoryJDBC.FilmRepositoryImplJDBC.findFilmList(FilmRepositoryImplJDBC.java:43)
	at com.tstu.service.FilmServiceImpl.findFilmList(FilmServiceImpl.java:34)
	at com.tstu.ui.states.FindFilmState.findFilmByName(FindFilmState.java:73)
	at com.tstu.ui.states.FindFilmState.handleCommand(FindFilmState.java:44)
	at com.tstu.ui.MenuState.enterCommand(MenuState.java:18)
	at com.tstu.ui.MenuState.display(MenuState.java:33)
	at com.tstu.ui.Menu.display(Menu.java:17)
	at com.tstu.ui.states.MainState.handleCommand(MainState.java:53)
	at com.tstu.ui.MenuState.enterCommand(MenuState.java:18)
	at com.tstu.ui.MenuState.display(MenuState.java:33)
	at com.tstu.ui.Menu.display(Menu.java:17)
	at com.tstu.App.main(App.java:22)
2019-11-05 15:48:50 jdbc[3]: exception
org.h2.jdbc.JdbcSQLException: Синтаксическая ошибка в выражении SQL "SELECT FILMS.*, GROUP_CONCAT(GENRES.NAME) AS GENRE FROM FILMS INNER JOIN FILM_GENERES ON FILMS.IMDBID = FILM_GENERES.FILM_ID LEFT JOIN GENRES ON FILM_GENERES.GENRE_ID = GENRES.ID GROUP BY FILMS.IMDBID WHERE[*] FILMS.NAME LIKE ? AND IMDBID LIKE ? AND TYPE LIKE ? AND RELEASEDATE LIKE ? "
Syntax error in SQL statement "SELECT FILMS.*, GROUP_CONCAT(GENRES.NAME) AS GENRE FROM FILMS INNER JOIN FILM_GENERES ON FILMS.IMDBID = FILM_GENERES.FILM_ID LEFT JOIN GENRES ON FILM_GENERES.GENRE_ID = GENRES.ID GROUP BY FILMS.IMDBID WHERE[*] FILMS.NAME LIKE ? AND IMDBID LIKE ? AND TYPE LIKE ? AND RELEASEDATE LIKE ? "; SQL statement:
SELECT films.*, GROUP_CONCAT(genres.name) AS genre FROM films INNER JOIN film_generes ON films.imdbId = film_generes.film_id LEFT JOIN genres ON film_generes.genre_id = genres.id GROUP BY films.imdbId WHERE films.name LIKE ? AND imdbId LIKE ? AND type LIKE ? AND releaseDate LIKE ? [42000-197]
2019-11-05 15:49:28 jdbc[3]: exception
org.h2.jdbc.JdbcSQLException: Синтаксическая ошибка в выражении SQL "SELECT FILMS.*, GROUP_CONCAT(GENRES.NAME) AS GENRE FROM FILMS INNER JOIN FILM_GENERES ON FILMS.IMDBID = FILM_GENERES.FILM_ID LEFT JOIN GENRES ON FILM_GENERES.GENRE_ID = GENRES.ID GROUP BY FILMS.IMDBID WHERE[*] NAME LIKE ? AND IMDBID LIKE ? AND TYPE LIKE ? AND RELEASEDATE LIKE ? "
Syntax error in SQL statement "SELECT FILMS.*, GROUP_CONCAT(GENRES.NAME) AS GENRE FROM FILMS INNER JOIN FILM_GENERES ON FILMS.IMDBID = FILM_GENERES.FILM_ID LEFT JOIN GENRES ON FILM_GENERES.GENRE_ID = GENRES.ID GROUP BY FILMS.IMDBID WHERE[*] NAME LIKE ? AND IMDBID LIKE ? AND TYPE LIKE ? AND RELEASEDATE LIKE ? "; SQL statement:
SELECT films.*, GROUP_CONCAT(genres.name) AS genre FROM films INNER JOIN film_generes ON films.imdbId = film_generes.film_id LEFT JOIN genres ON film_generes.genre_id = genres.id GROUP BY films.imdbId WHERE name LIKE ? AND imdbId LIKE ? AND type LIKE ? AND releaseDate LIKE ? [42000-197]
2019-11-05 15:51:00 jdbc[3]: exception
org.h2.jdbc.JdbcSQLException: Неоднозначное имя столбца "NAME"
Ambiguous column name "NAME"; SQL statement:
SELECT films.*, GROUP_CONCAT(genres.name) AS genre FROM films INNER JOIN film_generes ON films.imdbId = film_generes.film_id LEFT JOIN genres ON film_generes.genre_id = genres.id WHERE name LIKE ? AND imdbId LIKE ? AND type LIKE ? AND releaseDate LIKE ? GROUP BY films.imdbId  [90059-197]
	at org.h2.message.DbException.getJdbcSQLException(DbException.java:357)
	at org.h2.message.DbException.get(DbException.java:179)
	at org.h2.message.DbException.get(DbException.java:155)
	at org.h2.expression.ExpressionColumn.mapColumn(ExpressionColumn.java:127)
	at org.h2.expression.ExpressionColumn.mapColumns(ExpressionColumn.java:97)
	at org.h2.expression.CompareLike.mapColumns(CompareLike.java:482)
	at org.h2.expression.ConditionAndOr.mapColumns(ConditionAndOr.java:260)
	at org.h2.expression.ConditionAndOr.mapColumns(ConditionAndOr.java:260)
	at org.h2.expression.ConditionAndOr.mapColumns(ConditionAndOr.java:260)
	at org.h2.expression.ConditionAndOr.mapColumns(ConditionAndOr.java:260)
	at org.h2.command.dml.Select.mapColumns(Select.java:1240)
	at org.h2.command.dml.Select.init(Select.java:826)
	at org.h2.command.Parser.parseSelect(Parser.java:1925)
	at org.h2.command.Parser.parsePrepared(Parser.java:463)
	at org.h2.command.Parser.parse(Parser.java:335)
	at org.h2.command.Parser.parse(Parser.java:307)
	at org.h2.command.Parser.prepareCommand(Parser.java:278)
	at org.h2.engine.Session.prepareLocal(Session.java:611)
	at org.h2.engine.Session.prepareCommand(Session.java:549)
	at org.h2.jdbc.JdbcConnection.prepareCommand(JdbcConnection.java:1247)
	at org.h2.jdbc.JdbcPreparedStatement.<init>(JdbcPreparedStatement.java:76)
	at org.h2.jdbc.JdbcConnection.prepareStatement(JdbcConnection.java:304)
	at com.tstu.repositoryJDBC.FilmRepositoryImplJDBC.findFilmList(FilmRepositoryImplJDBC.java:35)
	at com.tstu.service.FilmServiceImpl.findFilmList(FilmServiceImpl.java:34)
	at com.tstu.ui.states.FindFilmState.findFilmByName(FindFilmState.java:73)
	at com.tstu.ui.states.FindFilmState.handleCommand(FindFilmState.java:44)
	at com.tstu.ui.MenuState.enterCommand(MenuState.java:18)
	at com.tstu.ui.MenuState.display(MenuState.java:33)
	at com.tstu.ui.Menu.display(Menu.java:17)
	at com.tstu.ui.states.MainState.handleCommand(MainState.java:53)
	at com.tstu.ui.MenuState.enterCommand(MenuState.java:18)
	at com.tstu.ui.MenuState.display(MenuState.java:33)
	at com.tstu.ui.Menu.display(Menu.java:17)
	at com.tstu.App.main(App.java:22)
